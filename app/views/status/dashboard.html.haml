%h1 Dashboard

.row
  .span5
    %h3 Running jobs
    %table
      %tbody
        - @jobs_running.each do |job|
          %tr
            %td= image_tag status_image_path(job)
            %td= "j#{job.id}"
            %td
              - label = job.label.blank? ? "job ##{job.id}" : job.label
              = link_to label, job
            %td
              started
              = seconds_ago(Time.now - job.started_at)

    %h3 Queued jobs
    %table
      %tbody
        - @jobs_runnable.each do |job|
          %tr
            %td= image_tag status_image_path(job)
            %td
              - label = job.label.blank? ? "job ##{job.id}" : job.label
              = link_to label, job
            %td
              created
              = seconds_ago(Time.now - job.created_at)
    
    %h3 Failed/suspended jobs
    %table
      %tbody
        - @jobs_failed.each do |job|
          %tr
            %td= image_tag status_image_path(job)
            %td
              - label = job.label.blank? ? "job ##{job.id}" : job.label
              = link_to label, job
            %td
              created
              = seconds_ago(Time.now - job.created_at)
  
  .span3
    %h3 Workers status
    - @workers.each do |worker|
      .well
        %b= "#{worker.hostname} - #{worker.pid}"
        %br
        started
        = seconds_ago(Time.now - worker.created_at)
        %br
        running jobs:
        = worker.jobs.map{|j| "j#{j.id}"}.join(', ')

  .span4
    %h3 Systems status
    - @systems.each do |system|
      .well
        %b= "#{system.label}"
        .systemstatus{'data-source' => system_path(system, :json)}
          %small.details
          .progress
            .bar{:style => "width: 100%"}
              = "?"


